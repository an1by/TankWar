from helpmain import programm
import pygame

array = [[[[1, 1], [50, 50]], [[52, 1], [101, 50]], [[103, 1], [152, 50]], [[154, 1], [203, 50]], [[205, 1], [254, 50]], [[256, 1], [305, 50]], [[307, 1], [356, 50]], [[358, 1], [407, 50]], [[409, 1], [458, 50]], [[460, 1], [509, 50]]], [[[1, 52], [50, 101]], [[52, 52], [101, 101]], [[103, 52], [152, 101]], [[154, 52], [203, 101]], [[205, 52], [254, 101]], [[256, 52], [305, 101]], [[307, 52], [356, 101]], [[358, 52], [407, 101]], [[409, 52], [458, 101]], [[460, 52], [509, 101]]], [[[1, 103], [50, 152]], [[52, 103], [101, 152]], [[103, 103], [152, 152]], [[154, 103], [203, 152]], [[205, 103], [254, 152]], [[256, 103], [305, 152]], [[307, 103], [356, 152]], [[358, 103], [407, 152]], [[409, 103], [458, 152]], [[460, 103], [509, 152]]], [[[1, 154], [50, 203]], [[52, 154], [101, 203]], [[103, 154], [152, 203]], [[154, 154], [203, 203]], [[205, 154], [254, 203]], [[256, 154], [305, 203]], [[307, 154], [356, 203]], [[358, 154], [407, 203]], [[409, 154], [458, 203]], [[460, 154], [509, 203]]], [[[1, 205], [50, 254]], [[52, 205], [101, 254]], [[103, 205], [152, 254]], [[154, 205], [203, 254]], [[205, 205], [254, 254]], [[256, 205], [305, 254]], [[307, 205], [356, 254]], [[358, 205], [407, 254]], [[409, 205], [458, 254]], [[460, 205], [509, 254]]], [[[1, 256], [50, 305]], [[52, 256], [101, 305]], [[103, 256], [152, 305]], [[154, 256], [203, 305]], [[205, 256], [254, 305]], [[256, 256], [305, 305]], [[307, 256], [356, 305]], [[358, 256], [407, 305]], [[409, 256], [458, 305]], [[460, 256], [509, 305]]], [[[1, 307], [50, 356]], [[52, 307], [101, 356]], [[103, 307], [152, 356]], [[154, 307], [203, 356]], [[205, 307], [254, 356]], [[256, 307], [305, 356]], [[307, 307], [356, 356]], [[358, 307], [407, 356]], [[409, 307], [458, 356]], [[460, 307], [509, 356]]], [[[1, 358], [50, 407]], [[52, 358], [101, 407]], [[103, 358], [152, 407]], [[154, 358], [203, 407]], [[205, 358], [254, 407]], [[256, 358], [305, 407]], [[307, 358], [356, 407]], [[358, 358], [407, 407]], [[409, 358], [458, 407]], [[460, 358], [509, 407]]], [[[1, 409], [50, 458]], [[52, 409], [101, 458]], [[103, 409], [152, 458]], [[154, 409], [203, 458]], [[205, 409], [254, 458]], [[256, 409], [305, 458]], [[307, 409], [356, 458]], [[358, 409], [407, 458]], [[409, 409], [458, 458]], [[460, 409], [509, 458]]], [[[1, 460], [50, 509]], [[52, 460], [101, 509]], [[103, 460], [152, 509]], [[154, 460], [203, 509]], [[205, 460], [254, 509]], [[256, 460], [305, 509]], [[307, 460], [356, 509]], [[358, 460], [407, 509]], [[409, 460], [458, 509]], [[460, 460], [509, 509]]]]
def move(posblue,posred,tank,team,sc):
    choose = pygame.image.load("./assets/choose.png").convert_alpha()
    global array
    place = [[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0]]
    red = []
    blue = []
    led = []
    for i in posblue:
        for j in range(10):
            for k in range(10):
                if i[0] >= array[j][k][0][0] and i[0] <= array[j][k][1][0] and i[1] >= array[j][k][0][1] and i[1] <= array[j][k][1][1]:
                        place[j][k] = 1
                        blue.append([j,k])
    for i in posred:
        for j in range(10):
            for k in range(10):
                if i[0] >= array[j][k][0][0] and i[0] <= array[j][k][1][0] and i[1] >= array[j][k][0][1] and i[1] <= array[j][k][1][1]:
                        place[j][k] = 1
                        red.append([j,k])
    if team == "Красные":
        pos = red[tank]
    else:
        pos = blue[tank]
    x = pos[1]
    y = pos[0]
    
    for yi in range(-1,2):
        for xj in range(-1,2):
            if ((x + xj <= 9) and (x + xj >= 0)) and ((y + yi <= 9) and (y + yi >= 0)):
                if place[y + yi][x + xj] == 0:
                    led.append([x + xj, y + yi])
    ledindex = []
    for i in range(len(led)):
        index = led[i][1] * 10 + led[i][0]
        ledindex.append(array[led[i][1]][led[i][0]])
        #pygame.draw.rect(sc, (0, 0, 255),(array[led[i][1]][led[i][0]][0][0] + 10,array[led[i][1]][led[i][0]][0][1] +10,51,52))
        sc.blit(choose,(array[led[i][1]][led[i][0]][0][0]+11,array[led[i][1]][led[i][0]][0][1]+11))
    flag = False
    pygame.display.update()
    index = 0
    print(ledindex)
    while flag == False:
        inputpos = programm()
        print(inputpos)
        for i in range(len(led)):
            if inputpos[0][0] >= ledindex[i][0][0] and inputpos[0][0] <= ledindex[i][1][0] and inputpos[0][1] >= ledindex[i][0][1] and inputpos[0][1] <= ledindex[i][1][1]:
                index = i
                flag = True
                print(inputpos)
                break
    moveplace = led[index]
    print(moveplace)
    x = moveplace[0]
    y = moveplace[1]
    cntx = int((array[y][x][0][0] + array[y][x][1][0]) / 2)
    cnty = int((array[y][x][0][1] + array[y][x][1][1]) / 2)
    print(cntx,cnty)
    if team == "Красные":
        posred[tank][0] = cntx
        posred[tank][1] = cnty
        return [posred,posblue]
    else:
        posblue[tank][0] = cntx
        posblue[tank][1] = cnty
        return [posred,posblue]
        
    
